{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport axios from 'axios';\n\nconst searchForm = document.querySelector('.search');\nconst gallery = document.querySelector('.gallery');\nconst moreBtn = document.querySelector('.moreBtn');\nconst textInput = document.querySelector('.textInput');\nconst loader = document.querySelector('.loader');\nconst modal = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst perPage = 40;\n\nlet currentPage = 1;\nlet queryValue = ''; // current value of the search\n\nsearchForm.addEventListener('submit', onSearchSubmit);\nmoreBtn.addEventListener('click', onMoreSubmit);\n\nfunction onSearchSubmit(e) { // functions on search submit for search form\n  e.preventDefault(); // cancels the event on search submit\n  queryValue = e.target.elements.search.value; // get the value of the search\n  gallery.innerHTML = '';\n  textInput.value = '';\n  loader.style.visibility = 'visible';\n  currentPage = 1;\n  fetchDataBtn(formQueryUrl(queryValue, currentPage));\n}\n\nfunction onMoreSubmit(e) { // function on more submit button\n  moreBtn.style.visibility = 'hidden'; // more button is hidden\n  loader.style.visibility = 'visible'; // loader is visible\n  currentPage += 1; // increment the current page\n  moreDataBtn(formQueryUrl(queryValue, currentPage));\n}\n\nfunction formQueryUrl(value, page) { // form url with query value\n  const BASE_URL = 'https://pixabay.com/api';\n  const OPTIONS = new URLSearchParams({\n    orientation: 'horizontal',\n    image_type: 'photo',\n    safesearch: 'true',\n    key: '29710136-0ffe1ca247b000977a61f6ae2',\n    per_page: perPage,\n    page,\n  });\n  return `${BASE_URL}/?q=${value}&${OPTIONS.toString()}`;\n}\n\nasync function fetchDataBtn(requestData) { // fetch data, form result and resulting page\n  try {\n    currentPage = 1;\n    const response = await axios.get(requestData); // fetch data\n    loader.style.visibility = 'hidden'; // loader is hidden\n    if (response.status !== 200) {\n      myAlert(response.status); // show error message from server\n    }\n    if (response.data.hits.length === 0) { // no hits from server\n      myAlert(\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n      return;\n    }\n    const imagesHTML = response.data.hits.reduce((html, image) => {\n      return html + imageRender(image);\n    }, '');\n    gallery.insertAdjacentHTML('beforeend', imagesHTML); // add images set to gallery\n    modal.refresh(); // refresh SimpleLightbox\n    if (response.data.totalHits > currentPage * 40) { // check if out of total page hits\n      moreBtn.style.visibility = 'visible'; // show more button\n    } else {\n      moreBtn.style.visibility = 'hidden'; // hide more button\n      myAlert(\"We're sorry, but you've reached the end of search results.\");\n    }\n  } catch (error) {\n    myAlert(error.toString()); // show more error message\n  }\n}\n\nasync function moreDataBtn(requestData) { // button for more search results\n  try {\n    const response = await axios.get(requestData);\n    loader.style.visibility = 'hidden'; // loader is hidden\n    if (response.status !== 200) {\n      myAlert(response.status); // show error message from server\n    }\n    if (response.data.hits.length === 0) {\n      myAlert(\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n      return;\n    }\n    const imagesHTML = response.data.hits.reduce((html, image) => {\n      return html + imageRender(image);\n    }, '');\n    gallery.insertAdjacentHTML('beforeend', imagesHTML); // add images set to gallery\n    modal.refresh(); // refresh SimpleLightbox\n    if (response.data.totalHits > currentPage * 40) {\n      moreBtn.style.visibility = 'visible';\n      setScrolling(); // scroll to show more images\n    } else {\n      moreBtn.style.visibility = 'hidden';\n      moreBtn.removeEventListener('click', onMoreSubmit) // remove event listener for more button to release resources \n      myAlert(\"We're sorry, but you've reached the end of search results.\");\n    }\n  } catch (error) {\n    myAlert(error.toString()); // show more error message\n  }\n}\n\nfunction setScrolling() { // set scrolling gallery\n  window.scrollBy({\n    top: gallery.getBoundingClientRect().height * 0.04,\n    behavior: 'smooth',\n  });\n}\n\nfunction myAlert(message) { // alert message in iziToast form\n  iziToast.error({\n    message: message,\n    messageColor: '#FAFAFB',\n    backgroundColor: '#EF4040',\n    position: 'topRight',\n    transitionIn: 'flipInX',\n    transitionOut: 'flipOutX',\n  });\n}\n\nfunction imageRender(images) { // render fetched images\n  return `<li>\n        <a href=\"${images.largeImageURL}\">\n          <img src=\"${images.webformatURL}\" alt=\"${images.tags}\">\n        </a>\n        <div class=\"info\">\n          <div class=\"image-info\">\n            <span>Likes</span>\n            <span class=\"image-value\">${images.likes}</span>\n          </div>\n          <div class=\"image-info\">\n            <span>Views</span>\n            <span class=\"image-value\">${images.views}</span>\n          </div>\n          <div class=\"image-info\">\n            <span>Comments</span>\n            <span class=\"image-value\">${images.comments}</span>\n          </div>\n          <div class=\"image-info\">\n            <span>Downloads</span>\n            <span class=\"image-value\">${images.downloads}</span>\n          </div>\n        </div>\n      </li>\n    `;\n}\n"],"names":["searchForm","gallery","moreBtn","textInput","loader","modal","SimpleLightbox","perPage","currentPage","queryValue","onSearchSubmit","onMoreSubmit","e","fetchDataBtn","formQueryUrl","moreDataBtn","value","page","BASE_URL","OPTIONS","requestData","response","axios","myAlert","imagesHTML","html","image","imageRender","error","setScrolling","message","iziToast","images"],"mappings":"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"}